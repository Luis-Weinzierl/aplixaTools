<PageTitle>PDFEdit - Kombinieren</PageTitle>

<Modal @ref="_confirmClearModal" Title="Bestätigen">
    <Content>
        <span>Wollen sie wirklich ihr gesamtes Dokument löschen?</span>
    </Content>
    <Footer>
        <button type="button" class="btn btn-success" data-bs-dismiss="modal">Nein</button>
        <button type="button" class="btn btn-danger" @onclick="async _ => await ConfirmClearOnClick()">Ja</button>
    </Footer>
</Modal>

<section>
	<div class="file-upload">
		<h6>Dateien</h6>
		<div class="file-list">
			@for (int i = 0; i < _fileSources.Count; i++) {
				var index = i;
				<FileEntry FileName="@_fileSources[i].Name" Index="index" OnDelete="FileEntryOnDelete"/>
			}
		</div>
		<label class="file-input" for="file-input">
			<InputFile id="file-input" OnChange="@OnChange" multiple />
			<Icon Href="@Icons.AddFile"></Icon>
		</label>
	</div>
    <div class="input-pages">
		@for (int i = 0; i < _fileSources.Count; i++)
		{
			var index = i;
			<DocumentPages
				Document="@_fileSources[i]"
				Index="index"
				OnPageAdded="async (a, b) => await DocumentPagesOnPageAdded(a, b)" 
				OnDocumentAdded="async (a) => await DocumentPagesOnDocumentAdded(a)"
			/>
		}
	</div>
    <div class="output-pages">
		<div class="options">
			<Dropdown Options="PageSizes.Sizes.Keys" Default="4" OnValueChanged="async (i) => await PageSizeOnChanged(i)" />
			<Checkbox Label="Querformat" DefaultValue="false" ValueChanged="async (l) => await LandscapeOnChanged(l)" />
			<TextInput DefaultValue="@_outputDocumentFileName" Placeholder="Dateiname" ValueChanged="FileNameOnValueChanged" />
		</div>
		<div class="preview">
			@for (int i = 0; i < _outputDocumentPreviewPages.Count; i++) {
				var index = i;
				<div class="preview-image" @onclick="async _ => await OutputPagesOnPageRemoved(index)">
					<div class="overlay">
						<Icon Href="@Icons.Minus"/>
					</div>
					<img src="@_outputDocumentPreviewPages[i]" />
				</div>
			}
		</div>
		<div class="d-flex flex-row gap-1">
			<button class="btn btn-primary w-100" @onclick="ClearButtonOnClick">
				<Icon Href="@Icons.TrashCan" />
				Alle Entfernen
			</button>
			<button class="btn btn-primary w-100" @onclick="MergeButtonOnClick">
				<Icon Href="@Icons.Download" />
				Zusammenführen
			</button>
		</div>
	</div>
</section>